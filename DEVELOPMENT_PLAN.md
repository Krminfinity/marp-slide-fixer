# 開発計画書

## フェーズ1: プロジェクトセットアップ (1日目)

### 1.1 初期設定
- [ ] package.json作成（ESM設定、依存関係）
- [ ] プロジェクト構造作成
- [ ] ESLint/Prettier設定
- [ ] Git設定

### 1.2 主要依存関係
```json
{
  "dependencies": {
    "remark": "^15.0.0",
    "remark-parse": "^11.0.0", 
    "remark-stringify": "^11.0.0",
    "puppeteer": "^21.0.0",
    "commander": "^11.0.0",
    "chalk": "^5.3.0"
  }
}
```

## フェーズ2: コア機能実装 (2-3日目)

### 2.1 markdown.js
- [ ] Markdown → AST 変換
- [ ] スライド境界認識（thematicBreak）
- [ ] AST → Markdown 変換
- [ ] 基本分割ロジック

### 2.2 detector.js  
- [ ] marp CLI実行（HTML生成）
- [ ] Puppeteer設定・起動
- [ ] overflow検知ロジック
- [ ] 一時ファイル管理

### 2.3 pipeline.js
- [ ] 全体制御フロー
- [ ] 反復処理
- [ ] 状態管理

## フェーズ3: 分割アルゴリズム (4-5日目)

### 3.1 リスト分割
- [ ] li要素カウント
- [ ] 中央付近分割
- [ ] ネストリスト対応

### 3.2 段落分割
- [ ] 文字数計測
- [ ] 句読点認識
- [ ] 自然な境界探索

### 3.3 見出し分割
- [ ] セクション分析
- [ ] ブロック再配分

## フェーズ4: 局所縮小機能 (6-7日目)

### 4.1 要素別縮小
- [ ] コードブロック縮小
- [ ] 表縮小
- [ ] 画像縮小

### 4.2 スライド全体縮小
- [ ] font-size段階的縮小
- [ ] クラス生成・適用
- [ ] front-matter更新

## フェーズ5: CLI実装 (8日目)

### 5.1 CLIインターフェース
- [ ] commander.js設定
- [ ] オプション解析
- [ ] ヘルプ表示

### 5.2 ログ・エラーハンドリング
- [ ] chalk.js色付きログ
- [ ] 進捗表示
- [ ] エラー処理

## フェーズ6: テスト・最適化 (9-10日目)

### 6.1 テストケース
- [ ] 単体テスト
- [ ] 統合テスト
- [ ] エッジケーステスト

### 6.2 パフォーマンス
- [ ] メモリ使用量最適化
- [ ] 処理時間改善
- [ ] 大ファイル対応

## フェーズ7: ドキュメント・公開準備 (11日目)

### 7.1 ドキュメント整備
- [ ] API仕様書
- [ ] 使用例
- [ ] トラブルシューティング

### 7.2 公開準備
- [ ] npm package設定
- [ ] バージョニング
- [ ] ライセンス確認

## 技術的な課題と対策

### 課題1: AST操作の複雑さ
**対策**: remarkプラグインの活用、単体テスト充実

### 課題2: Puppeteerの重い処理
**対策**: インスタンス再利用、並列処理制限

### 課題3: Marp互換性
**対策**: Marp公式テストケース参照、front-matter厳密解析

### 課題4: 分割の意味的正確性
**対策**: 自然言語処理ライブラリ検討、ヒューリスティクス調整

## 成功指標

- [ ] 実際のMarpファイル（20スライド以上）で80%以上のoverflow解消
- [ ] 処理時間: 50スライド未満で10秒以内
- [ ] メモリ使用量: 500MB未満
- [ ] front-matter完全保持率: 100%

## リスク管理

### 高リスク
- Marp CLI依存による環境依存問題
- Puppeteer起動失敗

### 中リスク  
- 大量スライド処理時のメモリ不足
- 複雑なMarkdown記法対応不足

### 低リスク
- CLI オプション解析エラー
- ログ出力の文字化け

---

**開発期間**: 2025年9月14日〜9月24日（11日間）
**開発者**: [名前]
**レビュー予定日**: 9月25日
